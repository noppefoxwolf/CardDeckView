# ZStackPagingLayout 仕様書

## 概要
ZStackPagingLayoutは、SwiftUIで実装された縦分割レイアウトライブラリです。画面を上下2つのエリアに分割し、複数の色付きビューをドラッグ操作でエリア間を移動できる機能を提供します。

## 主要機能

### 1. 画面レイアウト
- 画面を上下2つのエリアに等分割
- 上部エリア: 透明な背景
- 下部エリア: グレー（透明度0.2）の背景

### 2. ビューの表示
- 複数の色付きビューを表示（デフォルト: 赤、緑）
- 各ビューは100x100ptの矩形
- 初期状態では全てのビューが下部エリアに配置

### 3. ドラッグ機能
- 全てのビューがドラッグ可能
- ドラッグ中はビューが指の動きに追従
- ドラッグ終了時の位置に応じてエリア間移動を判定

### 4. エリア間移動
- 画面中央を境界として移動判定
- 下部エリアから上部エリアへの移動: ドラッグ終了位置が画面上半分の場合
- 上部エリアから下部エリアへの移動: ドラッグ終了位置が画面下半分の場合

## API仕様

### イニシャライザ
```swift
public init(colors: [Color] = [.red, .green])
```

#### パラメータ
- `colors`: 表示するビューの色配列
  - 型: `[Color]`
  - デフォルト値: `[.red, .green]`
  - 制限: なし（任意の数の色を指定可能）

#### 使用例
```swift
// デフォルト（赤、緑の2つのビュー）
ZStackPagingLayout()

// カスタム色配列
ZStackPagingLayout(colors: [.red, .green, .blue, .orange, .purple])
```

## 内部構造

### ViewState構造体
各ビューの状態を管理する構造体
```swift
struct ViewState {
    var isInUpperArea: Bool = false    // 上部エリアにあるかどうか
    var dragOffset: CGSize = .zero     // ドラッグオフセット
    var isDragging: Bool = false       // ドラッグ中かどうか
    var zIndex: Double                 // z軸での重ね順
}
```

### 状態管理
- `viewStates: [ViewState]`: 各ビューの状態配列
- `colors: [Color]`: 表示色配列
- 初期化は`onAppear`で実行

## 技術要件

### 対応プラットフォーム
- iOS 13.0+
- macOS 10.15+

### 使用フレームワーク
- SwiftUI
- Swift 6.2+

### 主要コンポーネント
- `GeometryReader`: 画面サイズ取得
- `VStack`: 上下エリア分割
- `ZStack`: ビュー重ね合わせ
- `DragGesture`: ドラッグ操作
- `ForEach`: 動的ビュー生成

## 動作フロー

### 1. 初期化
1. 色配列を受け取り
2. `onAppear`でViewState配列を初期化
3. 全ビューを下部エリアに配置

### 2. ドラッグ操作
1. ユーザーがビューをタップ&ドラッグ
2. `onChanged`: ドラッグオフセットをリアルタイム更新
3. `onEnded`: ドラッグ終了位置で移動判定

### 3. エリア移動
1. ドラッグ終了位置を画面中央と比較
2. 移動の場合: `isInUpperArea`フラグ更新
3. 上部エリア移動時: zIndexを最大値+1に更新
4. ドラッグオフセットをリセット

### 4. 描画更新
1. 状態変更によりSwiftUIが自動再描画
2. ForEachが各エリアの対象ビューのみ表示

## 制限事項
- ビューサイズは固定（100x100pt）
- ビューの形状は矩形のみ
- アニメーション効果なし
- ビューの削除・追加機能なし

## 拡張可能性
- ビューサイズのカスタマイズ
- アニメーション効果の追加
- 任意形状のビュー対応
- 3分割以上のエリア対応
- ビューの動的追加・削除機能
